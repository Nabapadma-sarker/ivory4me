jQuery(document).ready(function(){$container=jQuery(infinite_scroll.parent_container);if(jQuery('.ajax-layered a').length>0){jQuery('.ajax-layered a').live('click',function(){$container=jQuery(infinite_scroll.parent_container);$container.infinitescroll('destroy');$container.infinitescroll('reset');init_infinite_scroll($container);});}init_infinite_scroll($container);if(jQuery('body').height()<jQuery(window).height()){$container.infinitescroll('retrieve');}});function init_infinite_scroll($container){$container.infinitescroll({loading:{msgText:"<em>"+infinite_scroll.loading_msg+"</em>",finishedMsg:"<em>"+infinite_scroll.no_more_products+"</em>",img:infinite_scroll.image_path,selector:infinite_scroll.parent_container,},contentSelector:infinite_scroll.parent_container,itemSelector:infinite_scroll.item_container,navSelector:"div.sod-inf-nav-next",nextSelector:"div.sod-inf-nav-next a:first",debug:true,state:{isDestroyed:false,isDone:false},},function(newElements){$added=newElements.length;$total=jQuery(infinite_scroll.item_container).length;$lastElem=$total-$added;if(!jQuery(infinite_scroll.item_container+':nth-child('+$lastElem+')').hasClass("last")){$firstElem=jQuery(infinite_scroll.item_container).first();$last=false;$perRow=0;jQuery(newElements).each(function(index){$perRow++;$last=jQuery(this).hasClass('last');if($last){return false;}});$remainder=$added%$perRow;$getsLast=$perRow-$remainder;$getsFirst=$getsLast+1;$i=1;jQuery(infinite_scroll.item_container).each(function(index){if(jQuery(this).hasClass('first')){jQuery(this).removeClass('first');}if($i==1){jQuery(this).addClass('first');}if(jQuery(this).hasClass('last')){jQuery(this).removeClass('last');}if($i==$perRow){jQuery(this).addClass('last');$i=0;}$i++;});}});}